{% extends "base.html" %}

{% block content %}
  <h2>DB Explorer</h2>

  <form method="POST" action="{{ url_for('dbexplorer') }}" style="margin-bottom: 1rem;">
    <input
      type="text"
      name="q"
      placeholder="Type club / player / coach / league name..."
      value="{{ q|default('') }}"
      style="min-width: 320px; padding: 0.4rem;"
      required
    />
    <button type="submit" style="padding: 0.45rem 0.8rem;">Search</button>
  </form>

  {# If nothing found anywhere, show nothing (blank results area) #}

  {% if club_players and club_players|length > 0 %}
    <h3>Club → Players (from Spieler)</h3>
    <table border="1" cellpadding="6" cellspacing="0">
      <thead>
        <tr>
          <th>Club</th>
          <th>spielernr</th>
          <th>vorname</th>
          <th>nachname</th>
          <th>position</th>
          <th>tore</th>
          <th>vorlagen</th>
          <th>marktwert</th>
        </tr>
      </thead>
      <tbody>
        {% for r in club_players %}
          <tr>
            <td>{{ r.club }}</td>
            <td>{{ r.spielernr }}</td>
            <td>{{ r.vorname }}</td>
            <td>{{ r.nachname }}</td>
            <td>{{ r.position }}</td>
            <td>{{ r.tore }}</td>
            <td>{{ r.vorlagen }}</td>
            <td>{{ r.marktwert }}</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% endif %}

  {% if player_rows and player_rows|length > 0 %}
    <h3>Player match(es) (from Spieler)</h3>
    <table border="1" cellpadding="6" cellspacing="0">
      <thead>
        <tr>
          <th>Club</th>
          <th>spielernr</th>
          <th>vorname</th>
          <th>nachname</th>
          <th>position</th>
          <th>tore</th>
          <th>vorlagen</th>
          <th>marktwert</th>
        </tr>
      </thead>
      <tbody>
        {% for r in player_rows %}
          <tr>
            <td>{{ r.club }}</td>
            <td>{{ r.spielernr }}</td>
            <td>{{ r.vorname }}</td>
            <td>{{ r.nachname }}</td>
            <td>{{ r.position }}</td>
            <td>{{ r.tore }}</td>
            <td>{{ r.vorlagen }}</td>
            <td>{{ r.marktwert }}</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% endif %}

  {% if coach_rows and coach_rows|length > 0 %}
    <h3>Coach match(es) (from Cheftrainer)</h3>
    <table border="1" cellpadding="6" cellspacing="0">
      <thead>
        <tr>
          <th>Club</th>
          <th>trainernr</th>
          <th>vorname</th>
          <th>nachname</th>
          <th>team</th>
        </tr>
      </thead>
      <tbody>
        {% for r in coach_rows %}
          <tr>
            <td>{{ r.club }}</td>
            <td>{{ r.trainernr }}</td>
            <td>{{ r.vorname }}</td>
            <td>{{ r.nachname }}</td>
            <td>{{ r.team }}</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% endif %}

  {% if league_teams and league_teams|length > 0 %}
    <h3>League match → Teams ordered by place</h3>
    <p>
      <strong>League:</strong> {{ league_teams[0].liga }}
      &nbsp; | &nbsp;
      <strong>Country:</strong> {{ league_teams[0].land }}
    </p>

    <table border="1" cellpadding="6" cellspacing="0">
      <thead>
        <tr>
          <th>platzierung</th>
          <th>club</th>
          <th>tore</th>
          <th>gegentore</th>
        </tr>
      </thead>
      <tbody>
        {% for r in league_teams %}
          <tr>
            <td>{{ r.platzierung }}</td>
            <td>{{ r.club }}</td>
            <td>{{ r.tore }}</td>
            <td>{{ r.gegentore }}</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% endif %}

{% endblock %}
